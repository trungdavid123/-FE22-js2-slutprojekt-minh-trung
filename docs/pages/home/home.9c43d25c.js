var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},l={},o=e.parcelRequireb36d;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in l){var o=l[e];delete l[e];var a={id:e,exports:{}};return t[e]=a,o.call(a.exports,a,a.exports),a.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){l[e]=t},e.parcelRequireb36d=o);var a=o("6AR8M"),i=o("ilpIi");const s=(0,i.getFirestore)(),n=(0,a.getAuth)(),r=(0,i.collection)(s,"posts"),c=document.getElementById("modal"),d=document.querySelector(".avatar"),p=document.querySelector(".user-name"),m=document.querySelector(".sign-out"),u=localStorage.getItem("user"),h=document.querySelector(".account-list"),g=u?JSON.parse(u):null,f=document.querySelector(".all-accounts"),v=document.querySelector(".posts-container"),w=document.querySelector(".user-navbar");let y="";const L=(0,i.collection)(s,"users");u||(window.location.href="/"),u&&(p.innerHTML=g.name||g.displayName||g.email.split("@")[0],d.src=g.photoURL?g.photoURL:"https://www.w3schools.com/howto/img_avatar.png"),c&&c.addEventListener("show.bs.modal",(()=>{document.querySelector(".btn-create-post").addEventListener("click",(()=>{!function(){const e=document.getElementById("title-modal"),t=document.getElementById("message-text"),l=document.querySelector(".btn-close");let o=localStorage.getItem("userList"),a=JSON.parse(o??"[]").filter((e=>e.email===g.email));e.value&&t.value&&((0,i.addDoc)(r,{title:e.value,msg:t.value,createdBy:a.length>0?a[0].id:null,name:g.displayName||g.email.split("@")[0],love:0,isLoved:[],photoURL:g.photoURL||"https://www.w3schools.com/howto/img_avatar.png",createdAt:(new Date).toISOString()}),l.click());e.value="",t.value=""}()}))})),(0,i.onSnapshot)(r,(e=>{let t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),S(t);document.querySelectorAll(".love-btn").forEach(((e,l)=>{e.addEventListener("click",(e=>{const o=t[l].id;let a=t[l].love,n=t[l].isLoved;const r=n?.some((e=>e.uid===g.uid));y=o;const c=(0,i.doc)(s,"posts",o);if(r){let e=n.filter((e=>e.uid!==g.uid));(0,i.updateDoc)(c,{love:a-1,isLoved:e})}else console.log("No matched"),(0,i.updateDoc)(c,{love:a+1,isLoved:[...n,g]})}))}))}));const S=e=>{v.innerHTML="",e.sort(((e,t)=>{const l=e.createdAt?new Date(e.createdAt):new Date(0);return(t.createdAt?new Date(t.createdAt):new Date(0)).getTime()-l.getTime()})).map((e=>{const t=` <div class="card w-100 mb-3"> <div class="card-body"><a href="../profile/profile.html?id=${e.createdBy}" class="d-flex align-items-center gap-2 mb-3">\n        <img class="avatar" style="width: 30px; height: 30px;"\n            src="${e.photoURL?e.photoURL:"https://www.w3schools.com/howto/img_avatar.png"}" alt="user">\n        <p class="user-name">${e.name||e.displayName}</p>\n        </a>\n        <h5 class="card-title">${e.title}</h5>\n        <p class="card-text">${e.msg}</p>\n            <div class="d-flex align-items-center gap-2">\n               <i class="love-btn bi bi-heart${e.isLoved?.some((e=>e.uid===g.uid))?"-fill":""}"></i> ${e.love}\n            </div>\n        </div></div>`;v.innerHTML+=t}))};w.addEventListener("click",(e=>{let t=localStorage.getItem("userList"),l=JSON.parse(t??"[]").filter((e=>e.email===g.email));window.location.href=`../profile/profile.html?id=${l[0].id}`})),m.addEventListener("click",(()=>{(0,a.signOut)(n).then((()=>{localStorage.removeItem("user"),window.location.href="../../index.html"})).catch((e=>{console.log(e.message)}))})),(0,i.onSnapshot)(L,(e=>{let t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),t.map((e=>{if(e.isSuggested){let t=`\n                    <li class="list-group-item">\n                        <a href="../profile/profile.html?id=${e.id}" class="d-flex align-items-center gap-2">\n                            <img class="avatar" style="width: 30px; height: 30px;"\n                                src=${e.photoURL} alt="user">\n                            <p class="user-name">${e.displayName?.split(" ").slice(0,2).join(" ")}</p>\n                            <i class="bi bi-flag-fill icon-flag"></i>\n                        </a>\n                </li>\n                 `;h.innerHTML+=t}}))})),(0,i.onSnapshot)(L,(e=>{let t=[];e.docs.forEach((e=>{let l=e.data();t.push({...l,id:e.id})})),localStorage.setItem("userList",JSON.stringify(t)),console.log(t),t.map((e=>{let t=`\n                    <li class="list-group-item">\n                        <a href="../profile/profile.html?id=${e.id}" class="d-flex align-items-center gap-2">\n                            <img class="avatar" style="width: 30px; height: 30px;"\n                                src=${e.photoURL||"https://www.w3schools.com/howto/img_avatar.png"} alt="user">\n                            <p class="user-name">${e.displayName?.split(" ").slice(0,2).join(" ")||e.email.split("@")[0]}</p>\n                        </a>\n                </li>\n                 `;f.innerHTML+=t}))}));
//# sourceMappingURL=home.9c43d25c.js.map
