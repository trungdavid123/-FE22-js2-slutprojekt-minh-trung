var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},l=e.parcelRequireb36d;null==l&&((l=function(e){if(e in t)return t[e].exports;if(e in o){var l=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,l.call(a.exports,a,a.exports),a.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},e.parcelRequireb36d=l);var a=l("6AR8M"),i=l("ilpIi");const s=(0,i.getFirestore)(),n=(0,a.getAuth)(),r=(0,i.collection)(s,"posts"),c=document.getElementById("modal"),d=document.querySelector(".avatar"),p=document.querySelector(".user-name"),m=document.querySelector(".sign-out"),u=localStorage.getItem("user"),h=document.querySelector(".account-list"),g=u?JSON.parse(u):null,f=document.querySelector(".all-accounts"),v=document.querySelector(".posts-container"),w=document.querySelector(".user-navbar");let y="";const L=(0,i.collection)(s,"users");u||(window.location.href="/"),u&&(p.innerHTML=g.name||g.displayName||g.email.split("@")[0],d.src=g.photoURL?g.photoURL:"https://www.w3schools.com/howto/img_avatar.png"),c&&c.addEventListener("show.bs.modal",(()=>{document.querySelector(".btn-create-post").addEventListener("click",(()=>{!function(){const e=document.getElementById("title-modal"),t=document.getElementById("message-text"),o=document.querySelector(".btn-close");let l=localStorage.getItem("userList"),a=JSON.parse(l??"[]").filter((e=>e.email===g.email));e.value&&t.value&&((0,i.addDoc)(r,{title:e.value,msg:t.value,createdBy:a.length>0?a[0].id:null,name:g.displayName||g.email.split("@")[0],love:0,isLoved:[],photoURL:g.photoURL||"https://www.w3schools.com/howto/img_avatar.png",createdAt:(new Date).toISOString()}),o.click());e.value="",t.value=""}()}))})),(0,i.onSnapshot)(r,(e=>{let t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),S(t);document.querySelectorAll(".love-btn").forEach(((e,o)=>{e.addEventListener("click",(e=>{const l=t[o].id;let a=t[o].love,n=t[o].isLoved;const r=n?.some((e=>e.uid===g.uid));y=l;const c=(0,i.doc)(s,"posts",l);if(r){let e=n.filter((e=>e.uid!==g.uid));(0,i.updateDoc)(c,{love:a-1,isLoved:e})}else console.log("No matched"),(0,i.updateDoc)(c,{love:a+1,isLoved:[...n,g]})}))}))}));const S=e=>{v.innerHTML="",e.sort(((e,t)=>{const o=e.createdAt?new Date(e.createdAt):new Date(0);return(t.createdAt?new Date(t.createdAt):new Date(0)).getTime()-o.getTime()})).map((e=>{const t=` <div class="card w-100 mb-3"> <div class="card-body"><a href="../profile/profile.html?id=${e.createdBy}" class="d-flex align-items-center gap-2 mb-3">\n        <img class="avatar" style="width: 30px; height: 30px;"\n            src="${e.photoURL?e.photoURL:"https://www.w3schools.com/howto/img_avatar.png"}" alt="user">\n        <p class="user-name">${e.name||e.displayName}</p>\n        </a>\n        <h5 class="card-title">${e.title}</h5>\n        <p class="card-text">${e.msg}</p>\n            <div class="d-flex align-items-center gap-2">\n               <i class="love-btn bi bi-heart${e.isLoved?.some((e=>e.uid===g.uid))?"-fill":""}"></i> ${e.love}\n            </div>\n        </div></div>`;v.innerHTML+=t}))};m.addEventListener("click",(()=>{(0,a.signOut)(n).then((()=>{window.location.href="/",localStorage.removeItem("user")})).catch((e=>{console.log(e.message)}))})),w.addEventListener("click",(e=>{let t=localStorage.getItem("userList"),o=JSON.parse(t??"[]").filter((e=>e.email===g.email));window.location.href=`../profile/profile.html?id=${o[0].id}`})),(0,i.onSnapshot)(L,(e=>{let t=[];e.docs.forEach((e=>{t.push({...e.data(),id:e.id})})),t.map((e=>{if(e.isSuggested){let t=`\n                    <li class="list-group-item">\n                        <a href="../profile/profile.html?id=${e.id}" class="d-flex align-items-center gap-2">\n                            <img class="avatar" style="width: 30px; height: 30px;"\n                                src=${e.photoURL} alt="user">\n                            <p class="user-name">${e.displayName?.split(" ").slice(0,2).join(" ")}</p>\n                            <i class="bi bi-flag-fill icon-flag"></i>\n                        </a>\n                </li>\n                 `;h.innerHTML+=t}}))})),(0,i.onSnapshot)(L,(e=>{let t=[];e.docs.forEach((e=>{let o=e.data();t.push({...o,id:e.id})})),localStorage.setItem("userList",JSON.stringify(t)),console.log(t),t.map((e=>{let t=`\n                    <li class="list-group-item">\n                        <a href="../profile/profile.html?id=${e.id}" class="d-flex align-items-center gap-2">\n                            <img class="avatar" style="width: 30px; height: 30px;"\n                                src=${e.photoURL||"https://www.w3schools.com/howto/img_avatar.png"} alt="user">\n                            <p class="user-name">${e.displayName?.split(" ").slice(0,2).join(" ")||e.email.split("@")[0]}</p>\n                        </a>\n                </li>\n                 `;f.innerHTML+=t}))}));
//# sourceMappingURL=home.64b2b48f.js.map
